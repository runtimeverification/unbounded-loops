
module GAUSS-CONTRACT

    imports EVM

    syntax Bytes ::= "#binRuntime" [function]

    rule #binRuntime => #parseByteStack ( "0x60806040523480156100115760006000fd5b50600436106100ca5760003560e01c80631ed7831c146100d057806327cd9d9e146100ee5780632ade38801461011e5780633e5e3c231461013c5780633f7286f41461015a57806348e214771461017857806366d9a9a01461019457806385226c81146101b2578063899b121d146101d0578063916a17c614610200578063b5508aa91461021e578063ba414fa61461023c578063c6800cf01461025a578063e20c9f7114610276578063fa7626d414610294576100ca565b60006000fd5b6100d86102b2565b6040516100e59190610f5f565b60405180910390f35b61010860048036038101906101039190610fd0565b610345565b604051610115919061100c565b60405180910390f35b610126610393565b6040516101339190611278565b60405180910390f35b610144610533565b6040516101519190610f5f565b60405180910390f35b6101626105c6565b60405161016f9190610f5f565b60405180910390f35b610192600480360381019061018d9190610fd0565b610659565b005b61019c61072b565b6040516101a9919061146a565b60405180910390f35b6101ba610888565b6040516101c79190611512565b60405180910390f35b6101ea60048036038101906101e59190610fd0565b61096a565b6040516101f7919061100c565b60405180910390f35b61020861099c565b604051610215919061146a565b60405180910390f35b610226610af9565b6040516102339190611512565b60405180910390f35b610244610bdb565b604051610251919061154f565b60405180910390f35b610274600480360381019061026f9190610fd0565b610d8f565b005b61027e610da2565b60405161028b9190610f5f565b60405180910390f35b61029c610e35565b6040516102a9919061154f565b60405180910390f35b6060601460005080548060200260200160405190810160405280929190818152602001828054801561033957602002820191906000526020600020905b8160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190600101908083116102ef575b50505050509050805090565b60006000600090506000600090505b83811015610382576001816103699190611581565b9050805080826103799190611581565b91508150610354565b819250505061038e5650505b919050565b6060601b600050805480602002602001604051908101604052809291908181526020016000905b8282101561052857838290600052602060002090600202016000506040518060400160405290816000820160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200160018201600050805480602002602001604051908101604052809291908181526020016000905b8282101561050e57838290600052602060002090016000508054610481906115cc565b80601f01602080910402602001604051908101604052809291908181526020018280546104ad906115cc565b80156104fa5780601f106104cf576101008083540402835291602001916104fa565b820191906000526020600020905b8154815290600101906020018083116104dd57829003601f168201915b50505050508152602001906001019061045e565b5050505081526020015050815260200190600101906103ba565b505050509050805090565b606060166000508054806020026020016040519081016040528092919081815260200182805480156105ba57602002820191906000526020600020905b8160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019060010190808311610570575b50505050509050805090565b6060601560005080548060200260200160405190810160405280929190818152602001828054801561064d57602002820191906000526020600020905b8160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019060010190808311610603575b50505050509050805090565b7f885cb69240a935d632d79c317109709ecfa91a80626ff3989d68f67f5b1dd12d60001c73ffffffffffffffffffffffffffffffffffffffff16634c63e56270010000000000000000000000000000000083106040518263ffffffff1660e01b81526004016106c8919061154f565b60006040518083038186803b1580156106e15760006000fd5b505afa1580156106f6573d600060003e3d6000fd5b505050506107098161096a63ffffffff16565b6107188261034563ffffffff16565b14151561072857610727611600565b5b50565b60606019600050805480602002602001604051908101604052809291908181526020016000905b8282101561087d57838290600052602060002090600202016000506040518060400160405290816000820160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020016001820160005080548060200260200160405190810160405280929190818152602001828054801561086257602002820191906000526020600020906000905b82829054906101000a900460e01b7bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19168152602001906004019060208260030104928301926001038202915080841161080f5790505b50505050508152602001505081526020019060010190610752565b505050509050805090565b60606018600050805480602002602001604051908101604052809291908181526020016000905b8282101561095f578382906000526020600020900160005080546108d2906115cc565b80601f01602080910402602001604051908101604052809291908181526020018280546108fe906115cc565b801561094b5780601f106109205761010080835404028352916020019161094b565b820191906000526020600020905b81548152906001019060200180831161092e57829003601f168201915b5050505050815260200190600101906108af565b505050509050805090565b6000600260018361097b9190611581565b836109869190611617565b6109909190611672565b9050610997565b919050565b6060601a600050805480602002602001604051908101604052809291908181526020016000905b82821015610aee57838290600052602060002090600202016000506040518060400160405290816000820160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200160018201600050805480602002602001604051908101604052809291908181526020018280548015610ad357602002820191906000526020600020906000905b82829054906101000a900460e01b7bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191681526020019060040190602082600301049283019260010382029150808411610a805790505b505050505081526020015050815260200190600101906109c3565b505050509050805090565b60606017600050805480602002602001604051908101604052809291908181526020016000905b82821015610bd057838290600052602060002090016000508054610b43906115cc565b80601f0160208091040260200160405190810160405280929190818152602001828054610b6f906115cc565b8015610bbc5780601f10610b9157610100808354040283529160200191610bbc565b820191906000526020600020905b815481529060010190602001808311610b9f57829003601f168201915b505050505081526020019060010190610b20565b505050509050805090565b6000600760019054906101000a900460ff1615610c0d57600760019054906101000a900460ff169050610d8c56610d8b565b600060009050610c21610e4863ffffffff16565b15610d815760007f885cb69240a935d632d79c317109709ecfa91a80626ff3989d68f67f5b1dd12d60001c60601b60601c73ffffffffffffffffffffffffffffffffffffffff167f667f9d70ca411d70ead50d8d5c22070dafc36ad75f3dcf5e7237b22ade9aecc47f885cb69240a935d632d79c317109709ecfa91a80626ff3989d68f67f5b1dd12d60001c60601b60601c7f6661696c65640000000000000000000000000000000000000000000000000000604051602001610ce59291906116cd565b604051602081830303815290604052604051602001610d0592919061175e565b604051602081830303815290604052604051610d219190611786565b6000604051808303816000865af19150503d8060008114610d5e576040519150601f19603f3d011682016040523d82523d6000602084013e610d63565b606091505b5091505080806020019051810190610d7b91906117cc565b91508150505b80915050610d8c56505b5b90565b610d9e8161034563ffffffff16565b5050565b60606013600050805480602002602001604051908101604052809291908181526020018280548015610e2957602002820191906000526020600020905b8160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019060010190808311610ddf575b50505050509050805090565b600760009054906101000a900460ff1681565b6000600060009050737109709ecfa91a80626ff3989d68f67f5b1dd12d3b905060008111915050610e7556505b90566117f9565b600081519050919050565b600082825260208201905092915050565b6000819050602082019050919050565b60006001600160a01b0382169050919050565b6000610ec682610ea8565b9050919050565b610ed681610ebb565b82525050565b6000610ee88383610ecd565b60208301905092915050565b6000602082019050919050565b6000610f0c82610e7c565b610f168185610e87565b9350610f2183610e98565b8060005b83811015610f52578151610f398882610edc565b9750610f4483610ef4565b925050600181019050610f25565b8694505050505092915050565b60006020820190508181036000830152610f798184610f01565b905092915050566000604051905090565b60006000fd5660006000fd565b6000819050919050565b610faa81610f97565b81141515610fb85760006000fd5b50565b600081359050610fca81610fa1565b92915050565b600060208284031215610fe657610fe5610f8a565b5b6000610ff484828501610fbb565b91505092915050565b61100681610f97565b82525050565b60006020820190506110216000830184610ffd565b92915050565b600081519050919050565b600082825260208201905092915050565b6000819050602082019050919050565b600081519050919050565b600082825260208201905092915050565b6000819050602082019050919050565b600081519050919050565b600082825260208201905092915050565b60005b838110156110b957808201518184015260208101905061109e565b60008484015250505050565b6000601f19601f8301169050919050565b60006110e18261107f565b6110eb818561108a565b93506110fb81856020860161109b565b611104816110c5565b840191505092915050565b600061111b83836110d6565b905092915050565b6000602082019050919050565b600061113b82611053565b611145818561105e565b9350836020820285016111578561106f565b8060005b858110156111935784840389528151611174858261110f565b945061117f83611123565b925060208a0199505060018101905061115b565b83985088965050505050505092915050565b60006040830160008301516111bd6000860182610ecd565b602084015185830360208701526111d48382611130565b925082935050505092915050565b60006111ee83836111a5565b905092915050565b6000602082019050919050565b600061120e82611027565b6112188185611032565b93508360208202850161122a85611043565b8060005b85811015611266578484038952815161124785826111e2565b9450611252836111f6565b925060208a0199505060018101905061122e565b83985088965050505050505092915050565b600060208201905081810360008301526112928184611203565b905092915050565b600081519050919050565b600082825260208201905092915050565b6000819050602082019050919050565b600081519050919050565b600082825260208201905092915050565b6000819050602082019050919050565b600063ffffffff60e01b82169050919050565b61130e816112f2565b82525050565b60006113208383611305565b60208301905092915050565b6000602082019050919050565b6000611344826112c6565b61134e81856112d1565b9350611359836112e2565b8060005b8381101561138a5781516113718882611314565b975061137c8361132c565b92505060018101905061135d565b8694505050505092915050565b60006040830160008301516113af6000860182610ecd565b602084015185830360208701526113c68382611339565b925082935050505092915050565b60006113e08383611397565b905092915050565b6000602082019050919050565b60006114008261129a565b61140a81856112a5565b93508360208202850161141c856112b6565b8060005b85811015611458578484038952815161143985826113d4565b9450611444836113e8565b925060208a01995050600181019050611420565b83985088965050505050505092915050565b6000602082019050818103600083015261148481846113f5565b905092915050565b600082825260208201905092915050565b60006114a882611053565b6114b2818561148c565b9350836020820285016114c48561106f565b8060005b8581101561150057848403895281516114e1858261110f565b94506114ec83611123565b925060208a019950506001810190506114c8565b83985088965050505050505092915050565b6000602082019050818103600083015261152c818461149d565b905092915050565b60008115159050919050565b61154981611534565b82525050565b60006020820190506115646000830184611540565b92915050565b634e487b7160e01b600052601160045260246000fd565b600061158c82610f97565b915061159783610f97565b92508282019050808211156115af576115ae61156a565b5b92915050565b634e487b7160e01b600052602260045260246000fd565b6000600282049050600182168015156115e657607f821691505b602082108114156115fa576115f96115b5565b5b50919050565b634e487b7160e01b600052600160045260246000fd565b600061162282610f97565b915061162d83610f97565b925082820261163b81610f97565b9150828204841483151715156116545761165361156a565b5b5092915050565b634e487b7160e01b600052601260045260246000fd565b600061167d82610f97565b915061168883610f97565b925082151561169a5761169961165b565b5b828204905092915050565b6116ae81610ebb565b82525050565b6000819050919050565b6116c7816116b4565b82525050565b60006040820190506116e260008301856116a5565b6116ef60208301846116be565b9392505050565b6000819050919050565b61171161170c826112f2565b6116f6565b82525050565b600081519050919050565b600081905092915050565b600061173882611717565b6117428185611722565b935061175281856020860161109b565b80840191505092915050565b600061176a8285611700565b60048201915061177a828461172d565b91508190509392505050565b6000611792828461172d565b915081905092915050565b6117a681611534565b811415156117b45760006000fd5b50565b6000815190506117c68161179d565b92915050565b6000602082840312156117e2576117e1610f8a565b5b60006117f0848285016117b7565b91505092915050565bfea264697066735822122089b1e60252ee52adc2328e6bbc60aa54ae9aab43cdd6a302678be33819c0776364736f6c634300081a0033" )

    rule #sizeWordStack(WS           , N) => #sizeWordStack(WS, 0) +Int N requires N =/=Int 0                [simplification]
    rule #sizeWordStack(WS [ I := _ ], N) => #sizeWordStack(WS, N)        requires I <Int #sizeWordStack(WS) [simplification]
    rule 0 <=Int #sizeWordStack(_ , 0)    => true                                                            [simplification]
    rule #sizeWordStack(_ , 0) <Int N     => false                        requires N <=Int 0                 [simplification]

endmodule

module GAUSS-LEMMAS [symbolic]

    imports EVM
    imports EVM-TRACING
    imports GAUSS-CONTRACT

    rule  <k>
                ( JUMPI 898 CONDITION => JUMP 898 )
                ~> #pc [ JUMPI ]
                ~> #execute
                ~> _CONTINUATION:K
            </k>
            <program> BYTECODE </program>
            <pc> 860 </pc>
            <wordStack> ( I => N ) : ( RESULT => N *Int ( N +Int 1 ) /Int 2 ) : 0 : N : WS </wordStack>
            <useGas> false </useGas>
            <activeTracing> false </activeTracing>
            <jumpDests> DESTS </jumpDests>
    requires   0 <=Int N andBool N <Int 2 ^Int 128
       andBool 0 <=Int I andBool I <=Int N
       andBool RESULT ==Int I *Int (I +Int 1) /Int 2
       andBool #sizeWordStack(WS) <Int 1013
       andBool DESTS ==K #computeValidJumpDests( #binRuntime )
       andBool CONDITION ==K bool2Word ( N:Int <=Int I )
       andBool BYTECODE ==K #binRuntime
       [priority(40)]

endmodule

module LOOP-INVARIANTS

    imports EVM
    imports EVM-TRACING
    imports GAUSS-CONTRACT

    claim  <k>
                ( JUMPI 898 bool2Word ( N:Int <=Int I:Int ) => JUMP 898 )
                ~> #pc [ JUMPI ]
                ~> #execute
                ~> _CONTINUATION:K
            </k>
            <program> #binRuntime </program>
            <pc> 860 </pc>
            <wordStack> ( I => N ) : ( RESULT => N *Int ( N +Int 1 ) /Int 2 ) : 0 : N : WS </wordStack>
            <useGas> false </useGas>
            <activeTracing> false </activeTracing>
            <jumpDests> DESTS </jumpDests>
    requires   0 <=Int N andBool N <Int 2 ^Int 128
       andBool 0 <=Int I andBool I <=Int N
       andBool RESULT ==Int I *Int (I +Int 1) /Int 2
       andBool #sizeWordStack(WS) <Int 1013
       andBool DESTS ==K #computeValidJumpDests( #binRuntime )
    
endmodule
